<div class="bg-white dark:bg-gray-800">
  <div class="py-6 sm:px-6 lg:px-8 flex-1">
    <div class="px-4 py-6 sm:px-0">
      <!-- Header -->
      <div class="mb-8">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white">My AI Usage Cost</h1>
            <p class="mt-2 text-sm text-gray-600 dark:text-gray-300">
              Track your personal AI analysis costs and usage statistics
            </p>
          </div>
          <div class="text-right">
            <p class="text-sm text-gray-500 dark:text-gray-400">Signed in as</p>
            <p class="font-medium text-gray-900 dark:text-white"><%= current_user.display_name %></p>
          </div>
        </div>
      </div>

      <!-- Total Cost Card -->
      <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg shadow-lg p-6 mb-8">
        <div class="flex items-center justify-between">
          <div>
            <h2 class="text-2xl font-bold text-white">Your Total Cost</h2>
            <p class="text-blue-100">Your personal AI usage</p>
          </div>
          <div class="text-right">
            <div class="text-4xl font-bold text-white">$<%= sprintf('%.2f', @total_cost_dollars) %></div>
            <div class="text-blue-100 text-sm">
              <%= number_with_delimiter(@total_tokens) %> tokens used
            </div>
          </div>
        </div>
      </div>

      <!-- User-Friendly Statistics Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Average Cost per Analysis -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Avg Cost per Analysis</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.2f', @average_cost_per_action) %></p>
            </div>
          </div>
        </div>

        <!-- Smart Caching Savings -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Smart Caching Savings</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.2f', @cache_savings_dollars || 0) %></p>
              <p class="text-xs text-gray-500 dark:text-gray-400">This month</p>
            </div>
          </div>
        </div>

        <!-- Total AI Actions -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Total AI Actions</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white"><%= number_with_delimiter(@total_ai_actions) %></p>
            </div>
          </div>
        </div>

        <!-- Total Documents -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Documents</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white"><%= number_with_delimiter(@total_documents) %></p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                <%= @active_documents %> active, <%= @deleted_documents %> deleted
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Cost Trends Section -->
      <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6 mb-8">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Cost Trends</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="text-center">
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">This Month</p>
            <p class="text-2xl font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.2f', @this_month_cost_dollars || 0) %></p>
          </div>
          <div class="text-center">
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Last Month</p>
            <p class="text-2xl font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.2f', @last_month_cost_dollars || 0) %></p>
          </div>
          <div class="text-center">
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">Change</p>
            <p class="text-lg font-medium <%= (@cost_change_percentage || 0) >= 0 ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400' %>">
              <%= (@cost_change_percentage || 0) >= 0 ? '+' : '' %><%= sprintf('%.1f', @cost_change_percentage || 0) %>%
            </p>
          </div>
        </div>
      </div>

      <!-- Show Technical Details Toggle -->
      <div class="text-center mb-6">
        <button id="show-technical-details" class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800 transition-all duration-200">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
          Show Technical Details
        </button>
      </div>

      <!-- Technical Details (Hidden by default) -->
      <div id="technical-details" class="hidden mb-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <!-- Average Tokens -->
          <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Avg Tokens/Event</p>
                <p class="text-2xl font-semibold text-gray-900 dark:text-white"><%= number_with_delimiter(@avg_tokens_per_event) %></p>
              </div>
            </div>
          </div>

          <!-- Cache Hit Rate -->
          <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Cache Hit Rate</p>
                <p class="text-2xl font-semibold text-gray-900 dark:text-white"><%= @cache_hit_rate %>%</p>
              </div>
            </div>
          </div>

          <!-- Cache Hits -->
          <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                </svg>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Cache Hits</p>
                <p class="text-2xl font-semibold text-gray-900 dark:text-white"><%= number_with_delimiter(@cache_hits) %></p>
              </div>
            </div>
          </div>

          <!-- Cost Breakdown Available -->
          <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0">
                <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
              </div>
              <div class="ml-4">
                <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Cost Breakdown</p>
                <p class="text-2xl font-semibold text-gray-900 dark:text-white">Available</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Cost Breakdown -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
          <!-- Cost by Event Type -->
          <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Your Cost by Event Type</h3>
            <div class="space-y-3">
              <% @costs_by_type.each do |event_type, cost| %>
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700 dark:text-gray-300"><%= event_type.titleize %></span>
                  <span class="text-sm font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.2f', cost) %></span>
                </div>
              <% end %>
            </div>
          </div>

          <!-- Cost by Model -->
          <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Your Cost by Model</h3>
            <div class="space-y-3">
              <% @costs_by_model.each do |model, cost| %>
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700 dark:text-gray-300"><%= model %></span>
                  <span class="text-sm font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.2f', cost) %></span>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <!-- Additional User Statistics -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <!-- Average Cost per Action -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Cost per Action</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.4f', @average_cost_per_action) %></p>
            </div>
          </div>
        </div>

        <!-- Average Cost per Document -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Cost per Document</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white">$<%= sprintf('%.4f', @average_cost_per_document) %></p>
            </div>
          </div>
        </div>

        <!-- Cache Efficiency -->
        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Cache Savings</p>
              <p class="text-2xl font-semibold text-gray-900 dark:text-white"><%= @cache_hits %> hits</p>
              <p class="text-xs text-gray-500 dark:text-gray-400">(<%= @cache_hit_rate %>% efficiency)</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Deleted Documents Summary -->
      <% if @deleted_documents > 0 %>
        <div class="bg-amber-50 border border-amber-200 rounded-lg p-6 mb-8">
          <div class="flex items-start">
            <div class="flex-shrink-0">
              <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
              </svg>
            </div>
            <div class="ml-3">
              <h3 class="text-lg font-medium text-amber-900">Deleted Documents Data Preserved</h3>
              <div class="mt-2 text-sm text-amber-700">
                <p>You have deleted <%= pluralize(@deleted_documents, 'document') %>, but we've preserved your AI usage data for billing and analytics:</p>
                <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div class="bg-white rounded-lg p-3 border border-amber-200">
                    <p class="text-xs font-medium text-amber-600 uppercase tracking-wider">Preserved Cost</p>
                    <p class="text-lg font-semibold text-amber-900">$<%= sprintf('%.2f', @deleted_documents_cost_dollars) %></p>
                  </div>
                  <div class="bg-white rounded-lg p-3 border border-amber-200">
                    <p class="text-xs font-medium text-amber-600 uppercase tracking-wider">Preserved Tokens</p>
                    <p class="text-lg font-semibold text-amber-900"><%= number_with_delimiter(@deleted_documents_tokens) %></p>
                  </div>
                  <div class="bg-white rounded-lg p-3 border border-amber-200">
                    <p class="text-xs font-medium text-amber-600 uppercase tracking-wider">Documents Deleted</p>
                    <p class="text-lg font-semibold text-amber-900"><%= @deleted_documents %></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>





      <!-- Recent Events -->
      <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Your Recent AI Events</h3>
        <div class="overflow-x-auto custom-scroll rounded-md">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-sm">
            <thead class="bg-gray-100 dark:bg-gray-700">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider sticky top-0 z-10 bg-gray-100 dark:bg-gray-700">Date</th>
                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider sticky top-0 z-10 bg-gray-100 dark:bg-gray-700">Document</th>
                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider sticky top-0 z-10 bg-gray-100 dark:bg-gray-700">Event Type</th>
                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider sticky top-0 z-10 bg-gray-100 dark:bg-gray-700">Cost</th>
                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider sticky top-0 z-10 bg-gray-100 dark:bg-gray-700">Cached</th>
              </tr>
            </thead>
            <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600">
              <% @recent_events.each do |event| %>
                <tr class="odd:bg-white even:bg-gray-50 dark:odd:bg-gray-700 dark:even:bg-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors">
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                    <%= event.created_at.strftime('%Y-%m-%d %H:%M') %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                    <% if event.document.present? %>
                      <%= link_to event.document.title, document_path(event.document), class: "text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300" %>
                    <% elsif event.deleted_document.present? %>
                      <span class="text-gray-500 dark:text-gray-400 italic">
                        <%= event.deleted_document.title %> (deleted)
                      </span>
                    <% else %>
                      <span class="text-gray-400 dark:text-gray-500">Unknown Document</span>
                    <% end %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                    <%= event.event_type.titleize %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900 dark:text-white">
                    $<%= sprintf('%.2f', event.cost_cents / 100.0) %>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <% if event.cached? %>
                      <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200">
                        Yes
                      </span>
                    <% else %>
                      <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                        No
                      </span>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Function to initialize the technical details toggle
function initializeTechnicalDetailsToggle() {
  const showTechnicalButton = document.getElementById('show-technical-details');
  const technicalDetails = document.getElementById('technical-details');

  if (showTechnicalButton && technicalDetails) {
    // Remove any existing event listeners to prevent duplicates
    const newButton = showTechnicalButton.cloneNode(true);
    showTechnicalButton.parentNode.replaceChild(newButton, showTechnicalButton);

    newButton.addEventListener('click', function() {
      if (technicalDetails.classList.contains('hidden')) {
        // Show technical details
        technicalDetails.classList.remove('hidden');
        newButton.innerHTML = `
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>
          </svg>
          Hide Technical Details
        `;
        newButton.classList.add('bg-gray-100', 'dark:bg-gray-700');
        newButton.classList.remove('bg-white', 'dark:bg-gray-800');
      } else {
        // Hide technical details
        technicalDetails.classList.add('hidden');
        newButton.innerHTML = `
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
          Show Technical Details
        `;
        newButton.classList.remove('bg-gray-100', 'dark:bg-gray-700');
        newButton.classList.add('bg-white', 'dark:bg-gray-800');
      }
    });

    console.log('Technical details toggle initialized successfully');
  } else {
    console.log('Technical details elements not found:', {
      button: !!showTechnicalButton,
      details: !!technicalDetails
    });
  }
}

// Initialize on DOM content loaded
document.addEventListener('DOMContentLoaded', initializeTechnicalDetailsToggle);

// Also initialize on window load as a fallback
window.addEventListener('load', initializeTechnicalDetailsToggle);

// Initialize immediately if DOM is already ready
if (document.readyState === 'loading') {
  // DOM is still loading, wait for DOMContentLoaded
} else {
  // DOM is already ready, initialize immediately
  initializeTechnicalDetailsToggle();
}
</script>
